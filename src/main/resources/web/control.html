
<html>

<head>
    
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" href="css/bootstrap.css">
</head>
<body>


      </div>

        <center>

            <br>
            <img src="http://192.168.3.4:8081/picture" id="picture">
            <br>
       </center>

      <div id="label">No face.</div>
      <div id="faces"></div>
      <br>
      <div id="names" class="names"></div>

      <div id="horizontalMovement" class="names"></div>

      <div id="verticalMovement" class="names"></div>

      <div id="debug" class="names"></div>
    <link rel="stylesheet" href="css/jquery-ui.min.css">
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    
    <script>

        var cameraAddress = "http://192.168.3.4:8081/picture";

        setInterval(refreshImage, 250);

        function refreshImage() {
            $("#picture").prop("src", "http://192.168.3.4:8081/picture?" + Math.random());
        }


        var closestFace;

        setInterval(checkForFaces, 250);
        function checkForFaces() {

            $.get("http://localhost/face", function(data){
                $("#label").text(JSON.stringify(data));

                $("#names").text("");


                var newClosestFace;

                data.faces.forEach(function (f) {

                    if(newClosestFace === undefined
                        || (f.rect.width * f.rect.height > newClosestFace.rect.width * newClosestFace.rect.hight))
                    {
                        newClosestFace = f;
                    }
                    
                });



                if(newClosestFace.matched)
                    $("#names").text("Hi " + newClosestFace.name + " is closest to me.");
                else
                    $("#names").text("I don't recognize you. But you are closest to me.");


                if(closestFace === undefined)
                    closestFace = newClosestFace;

                var horizontalMovement = newClosestFace.rect.left - closestFace.rect.left;

                var verticalMovement = newClosestFace.rect.top - closestFace.rect.top;

                if(horizontalMovement < 0)
                    $("#horizontalMovement").text("The closest face moved " + (horizontalMovement * -1) + " pixels LEFT.");
                else
                    $("#horizontalMovement").text("The closest face moved " + horizontalMovement + " pixels RIGHT.");


                if(verticalMovement < 0)
                    $("#verticalMovement").text("The closest face moved " + (verticalMovement * -1) + " pixels UP.");
                else
                    $("#verticalMovement").text("The closest face moved " + verticalMovement + " pixels DOWN.");

                closestFace = newClosestFace;
            })
        }



    </script>
    </div>
</body>
</html>